<!--pages/teacher/task-detail/task-detail.wxml-->
<view class="task-detail-container">
  <!-- çŠ¶æ€æ  -->
  <view class="status-bar">
    <text class="time">9:41</text>
    <view class="status-icons">
      <text class="signal">ğŸ“¶</text>
      <text class="battery">ğŸ”‹100%</text>
    </view>
  </view>

  <!-- å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-back" bindtap="onBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="nav-title">ä»»åŠ¡è¯¦æƒ…</view>
    <view class="nav-edit" bindtap="onEditTask">
      <text class="edit-text">ç¼–è¾‘</text>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content">
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <view class="task-info" wx:if="{{!loading && taskInfo}}">
      <!-- ä»»åŠ¡åŸºæœ¬ä¿¡æ¯ -->
      <view class="info-card">
        <view class="task-title">{{taskInfo.title}}</view>
        <view class="task-status status-{{taskInfo.status}}">{{taskInfo.status_text}}</view>
        <view class="task-desc">{{taskInfo.description}}</view>
        
        <view class="task-meta">
          <view class="meta-item">
            <text class="meta-label">å¼€å§‹æ—¶é—´:</text>
            <text class="meta-value">{{taskInfo.start_time}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-label">æˆªæ­¢æ—¶é—´:</text>
            <text class="meta-value">{{taskInfo.end_time}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-label">æ–‡ä»¶æ ¼å¼:</text>
            <text class="meta-value">{{taskInfo.allowed_formats.join(', ')}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-label">æœ€å¤§å¤§å°:</text>
            <text class="meta-value">{{taskInfo.max_file_size}}MB</text>
          </view>
        </view>
      </view>

      <!-- æäº¤ç»Ÿè®¡ -->
      <view class="stats-card">
        <view class="stats-title">æäº¤ç»Ÿè®¡</view>
        <view class="stats-grid">
          <view class="stat-item">
            <view class="stat-number">{{taskInfo.total_students}}</view>
            <view class="stat-label">æ€»å­¦ç”Ÿæ•°</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{taskInfo.submitted_count}}</view>
            <view class="stat-label">å·²æäº¤</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{taskInfo.on_time_count}}</view>
            <view class="stat-label">æŒ‰æ—¶æäº¤</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{taskInfo.total_students - taskInfo.submitted_count}}</view>
            <view class="stat-label">æœªæäº¤</view>
          </view>
        </view>
      </view>

      <!-- æäº¤åˆ—è¡¨ -->
      <view class="submissions-card">
        <view class="card-title">æäº¤è®°å½•</view>
        <view class="submission-list">
          <view class="submission-item" wx:for="{{submissions}}" wx:key="id" bindtap="onViewSubmission" data-id="{{item.id}}">
            <view class="submission-header">
              <view class="student-name">{{item.student_name}}</view>
              <view class="submission-status status-{{item.status}}">{{item.status_text}}</view>
            </view>
            <view class="submission-info">
              <view class="submission-time" wx:if="{{item.submitted_at}}">
                æäº¤æ—¶é—´: {{item.submitted_at}}
              </view>
              <view class="submission-score" wx:if="{{item.score}}">
                å¾—åˆ†: {{item.score}}
              </view>
            </view>
          </view>
          
          <view class="empty-state" wx:if="{{submissions.length === 0}}">
            <view class="empty-icon">ğŸ“</view>
            <view class="empty-text">æš‚æ— æäº¤è®°å½•</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
